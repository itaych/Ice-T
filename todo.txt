ice-t
-----
move DLI code into VBI1 and disable DLI. (done)
read RT8 less often (after 59 frames, read every frame until change seen) (done)
move non essential (clock) code from VBI1 to VBI2. maybe use clock_update as flag. increment it rather than set to 1. (done)
arrange memory. perhaps move title screen texts into banked area. (done)
colors (done)
fine scroll will ruin DLI markers. must restore when leaving fscrol mode. (done)
improve code efficiency. jump tables (done)
colors not blanked when redrawing line during resize (done)
colors not blanked when erasing lines or partial screen clears (done)
use "H:" if no "D:" (done)
reset term when hanging up and dialing (done)
VT52 emulation plus keypad and arrows, not including graphics characters (done)
VT102 and ANSI-BBS emulation (done)
	- sources: http://www.vt100.net/docs/vt102-ug/chapter5.html
				http://bjh21.me.uk/all-escapes/all-escapes.txt
handle_insert_delete_char (done)
various glitches related to double-width lines (done):
	checkerboard character (^X) is broken in dbl width mode.
	graphics chars screw up when switching line to double width.
	some characters (tilde/grave accent/curly brackets) misbehave when switching line width.
dump local file to terminal. jsr to dovt100?nocapture for each char. (done)
	- Any key to quit. Start: freeze. Select: slow to 9600 baud. Option: very slow.
settings>end of line: change "cr or lf" option to "lf alone" (unix compatible), "cr alone". (done)
Ascii upload bug due to usage of used zp variables (done)
file viewer: viewing a file whose size is a multiple of 256 (including 0) displays a single garbage character at the end. (done)
capture buffer indicator broken when full (done)
Flow control can cause visual bugs or crashes, especially when entering dial menu. probably a zp variable conflict.
	buffifnd (and buffdo) may use the following if xoff flow control acts: x, y, prchar/+1, cntrl/h. change to preserve them (except prchar) (done)

Rush: 1. Why is it still slow? 2. Why do some codes (clear screen?) still show on the screen? 3. What prevents "Rush" from being displayed during menus? 4. At chkrsh?ok there are calls that also call buffdo - could cause infinite recursion? 5. Cursor glitches.
xmodem upload: stray character displayed when returning to terminal? very rare and hard to catch.
for memory, consider moving "wind" buffers to scrollback bank, reducing scrollback size.

file xfers:
	x/ymodem failed due to close3 (done)
	ymodem-g sent redundant ACKs (done)
	zmodem sent redundant XON (done)
	x/ymodem: is only 15K of 16K buffer being used? (done)
	ymodem-g: doesn't work on real atari (probably wontfix)
	zmodem: initial ZRQINIT is not processed. (done. but not sending zchallenge as it just causes trouble)
	zmodem: why do we request buffer size 3fff and not 4000? (done, set to 4000)
	zmodem: (linux) breaks with -e option, hex packets ending with 0d 00 8a 11 instead of 0d 0a 11. (done)
		(the 00 was because of Altirra's broken Telnet, not accepting it.)
	zmodem: implement 8K packets? (probably not)
	zmodem: requesting nonexistent file = hang. (done)
	xmodem upload: implement. (done)
	zmodem: (linux) why does it overflow? (waiting for response from uwe)
	xmodem upload: can't upload hardfile (waiting for response from phaeron)
	
	Altirra has broken printer driver. (fixed in 2.4)
	Altirra R: breaks if you make outbound connection then coldstart while still connected. (fixed in 2.5)
	Altirra won't create a file if opening for append (aux1=9). (fixed in 2.5)
	Altirra in "raw" mode, emulated Atari can receive any character, but cannot send 0xFF. (fixed in 2.5 test 6)
	Altirra Telnet doesn't handle escape sequences or CR NUL properly so can't do any file transfer except Zmodem of plain text files. (fixed in 2.5 test 6)
	Altirra H: does not return an error if trying to delete/lock/unlock a nonexistent file (io commands 33/35/36 respectively). (fixed in 2.5 test 7)
	Altirra H: Rename (command 32) never returns an error, and incorrectly works on locked files. (fixed in 2.5 test 8)
	
	Altirra Telnet doesn't identify as any terminal type.

colors:
	spaces should generate colors if background color is set. add flag bit to 'boldface' variable. see ptxreg.
		however space should always bold/unbold if overwriting an existing char!
		that should fix emacs tetris.
	colors are ugly if screen is inverse. perhaps have dual color table, one for regular one for inverse.
	maybe do black text by enabling inverse video. Then background color takes priority.
	Fill new (cleared) lines with background color?

private extensions:
	Esc [ 99 ; cmd ; arg1 ; .. ; argn {

	- cmd=1: enable Atari color values. arg1=0 (default) foreground, 1=background (spaces/new lines too). arg2=color or absent for no color (use whatever color is already set). Esc [ 0 m (reset) or setting any ANSI color or bold disables.
	- cmd=2: n1;c1;c2;c3;c4;c5 [;n2;c1;c2;c3;c4;c5].. set all 5 colors for horizontal lines. row=0 means all rows. colors are even values, or: absent = no change; 1=repeat prev valid value (will be 0 if there was none).
	- cmd=10: force scroll down color table by arg1 lines (1-24).
	- cmd=11: force scroll up color table by arg1 lines (1-24).
	- cmd=12: horizontal move colors left (for lines within scroll region)
	- cmd=13: horizontal move colors right (for lines within scroll region)
	- cmd=20: set(1)/unset(0 or blank) scroll lock for color background.
	- cmd=21: set/unset rotate for vertical scroll (if set new line will get colors of scrolled out line)
	- cmd=22: set/unset rotate for horizontal scroll
	- cmd=30: vdelay

don't forget to generate new icet.dat for release!

known issues:
double width does not support 8-bit chars.
digraph characters are not correctly stored in text mirror, so may change when redrawing.
areas containing nothing but the checkerboard character may be considered blank by insert/delete char routines.
no proper detection of online status.

.loadsym C:\Emulators\Atari\ATasm\Projects\Ice-T\bin\icet.lab
e address byte
? expr

add to inittab or equivalent:
dt:12345:respawn:/sbin/agetty -L ttyS0 9600 vt100

or just: sudo /sbin/agetty -L ttyS0 9600 vt100

;tilmesg6
;	.byte	(80-77)/2,24,77
;	.byte	34,"Terminal je t'aime, I love you terminal, bella mia!",34," -Meir Ariel (1942-1999)"

col80:
------
hang when moving up in 'gandhi' txt file
garbage when moving up in icet doc
try to name unnamed labels/variables

.loadsym C:\Emulators\Atari\ATasm\Projects\Ice-T\Build\col80.lab
0d 0a
cr lf

lda v1
cmp v2
bcc ---> v1<v2
bcs ---> v1>=v2



------------
Telnet Negotiation on Altirra:

Ubuntu:  ff fd 18  ff fd 20  ff fd 23  ff fd 27
	Start use: term tpye, term speed, X location, env.option
Altirra: ff fc 18  ff fc 20  ff fc 23  ff fc 27             
	Won't use any of the above
Ubuntu:  ff fb 03  ff fd 01  ff fd 1f  ff fb 05  ff fd 21
	Will use Supress GA, Start use Echo, 1f. Will use 05, Start use 21.
Altirra: ff fd 03  ff fc 01  ff fc 1f  ff fe 05  ff fc 21
	Start use Supress GA, Won't use Echo, 1f. Stop use 05. Won't use 21.
Ubuntu:  ff fb 01                                         
	Will use Echo.
Altirra: ff fd 01            
	Start use Echo.

Telnet Negotiation on APE:

Ubuntu:  ff fd 18  ff fd 20  ff fd 23  ff fd 27            
	Start use: term type, term speed, X location, env.option
APE:     ff fb 18  ff fc 20  ff fc 23  ff fc 27                                                
	Will use term type. Won't use any of the others.
Ubuntu:  ff fa 18 01 ff f0
	Subnegotiate Term type, 1, end subnegotiation
APE:     ff fa 18 00 56 54 31 30 30 ff f0           
	Subnegotiate Term type, 0, "VT100", end subnegotiation
Ubuntu:  ff fb 03  ff fd 01  ff fd 1f  ff fb 05  ff fd 21
	Will use Supress GA, Start use Echo, 1f. Will use 05, Start use 21.
APE:     ff fd 03  ff fc 1f  ff fe 05  ff fc 21
	Start use Supress GA, Won't use 1f, Stop use 05, Won't use 21
Ubuntu:  ff fb 01                                         
	Will use Echo.
APE:     ff fd 01                                         
	Start use Echo.

With MS Telnet:

Ubuntu:  ff fd 18  ff fd 20  ff fd 23  ff fd 27
	Start use: term type, term speed, X location, env.option
MSTelnet:  ff fb 18 ff fb 1f  ff fc 20  ff fc 23  ff fb 27
	Will use term type, window size, env. option, not others.
Ubuntu:  ff fd 1f ff fa 27 01 ff f0 ff fa 18 01 ff f0
	Start using window size, subneg environment, term type. 
MSTelnet:  ff fa 1f 00 8c 00 32 ff f0
	Subnegotiate window size.
MSTelnet:  ff fa 27 00 ff f0 
    Subnegotiate environment option: 00.
           ff fa 18 00 41 4e 53 49 ff f0 (ANSI)
    Terminal type, 0, ANSI.		
Ubuntu:  ff fb 03 ff fd 01 ff fb 05 ff fd 21
MSTelnet:  ff fd 03 ff fb 01 ff fe 05 ff fc 21
Ubuntu:  ff fe 01 ff fb 01
MSTelnet:  ff fc 01
Ubuntu:  Ubuntu 13.10
MSTelnet:  ff fd 01
